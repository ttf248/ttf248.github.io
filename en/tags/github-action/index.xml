<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Github Action on Uncle Xiang&#39;s Notebook</title>
        <link>https://ttf248.life/en/tags/github-action/</link>
        <description>Recent content in Github Action on Uncle Xiang&#39;s Notebook</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <lastBuildDate>Sun, 25 May 2025 02:57:45 +0800</lastBuildDate><atom:link href="https://ttf248.life/en/tags/github-action/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Automatic system switchover</title>
        <link>https://ttf248.life/en/p/auto-integration-system-switch/</link>
        <pubDate>Sun, 29 Mar 2020 02:11:33 +0800</pubDate>
        
        <guid>https://ttf248.life/en/p/auto-integration-system-switch/</guid>
        <description>&lt;p&gt;Automatically deploy a Hugo blog to GitHub Pages and Gitee using GitHub Actions&lt;/p&gt;
&lt;h4 id=&#34;background-introduction&#34;&gt;Background introduction
&lt;/h4&gt;&lt;p&gt;While updating my blog yesterday, I discovered that the Travis service was unavailable. Checking the Travis webpage, I saw that the progress was stuck on pulling the source code. Suddenly, I remembered the action service recently launched by GitHub.&lt;/p&gt;
&lt;p&gt;Given that it will be quite busy and requires an application to use action, now that it has officially launched, and with free time this weekend, why not try out a new toy?&lt;/p&gt;
&lt;p&gt;You can find all official documents on the website, so I won&amp;rsquo;t reproduce them here. If you’ve used Kubernetes before, you’ll notice that the YAML configuration for actions is very similar to it.&lt;/p&gt;
&lt;p&gt;For introductory tutorials or Chinese language resources, I recommend searching &lt;strong&gt;阮一峰&amp;rsquo;s blog&lt;/strong&gt;. There are two articles: the first is an introduction to basic grammar, and the second is a practical case study.&lt;/p&gt;
&lt;h4 id=&#34;main-body&#34;&gt;Main body
&lt;/h4&gt;&lt;p&gt;Required knowledge points&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;github secrets&lt;/li&gt;
&lt;li&gt;action grammar&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The core job is completed using existing components, pushed to domestic Gitee using commands. The command part is quite rough, all force pushes, and inherits the logic used with Travis.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-yaml&#34;&gt;name: github pages and gitee pages

on:
  push:
    branches:
      - hugo

jobs:
  deploy:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true

      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: &#39;latest&#39;
          extended: true

      - name: Build Github and Gitee ## 单个step只能写一个run命令
        run: hugo -b &amp;quot;https://www.xiangtianlong.com/&amp;quot; -d &amp;quot;github_public&amp;quot; &amp;amp;&amp;amp; hugo -b &amp;quot;https://www.xiangtianlong.com/&amp;quot; -d &amp;quot;gitee_public&amp;quot; &amp;amp;&amp;amp; ls

      - name: Deploy Github
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.BLOG_TOKEN }}
          publish_dir: ./github_public
          publish_branch: master
          cname: xiangtianlong.com

      - name: Deploy Gitee
        run: cd ./gitee_public &amp;amp;&amp;amp; git init &amp;amp;&amp;amp; git config user.name &amp;quot;TianlongXiang&amp;quot; &amp;amp;&amp;amp; git config user.email &amp;quot;tianlongxiang51@gmail.com&amp;quot; &amp;amp;&amp;amp; git add . &amp;amp;&amp;amp; git commit -m &amp;quot;Update TianlongXiang&#39;s Blog&amp;quot; &amp;amp;&amp;amp; git push --force &amp;quot;https://xiangtianlong:${{ secrets.GITEE_PASSWORD }}@gitee.com/xiangtianlong/xiangtianlong.git&amp;quot; master:master   
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;afterword&#34;&gt;Afterword
&lt;/h4&gt;&lt;p&gt;Based on the actions provided by the official market, there are quite a few supported features currently available, and after building a Docker image, you no longer need to rely on services provided by Docker Hub&lt;/p&gt;
&lt;p&gt;I checked Hugo&amp;rsquo;s issues and found that when using GitHub Actions to automatically deploy Git Pages, the final published webpage needs to be on the master branch. If deployed to other branches, GitHub will display a message indicating that there are syntax problems with the deployment webpage in the settings interface.&lt;/p&gt;
&lt;p&gt;In reality, it&amp;rsquo;s because Hugo&amp;rsquo;s source files are located in the master branch, and GitHub is treating them as the source code for the Jelly blog, leading to errors that prevent checking and passing&lt;/p&gt;
&lt;p&gt;The solution is also simple: put the Hugo source files on another branch and publish the static files on the master branch&lt;/p&gt;</description>
        </item>
        
    </channel>
</rss>
