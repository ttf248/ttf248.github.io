<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Monitoring on Uncle Xiang&#39;s Notebook</title>
        <link>https://ttf248.life/en/tags/monitoring/</link>
        <description>Recent content in Monitoring on Uncle Xiang&#39;s Notebook</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <lastBuildDate>Sun, 25 May 2025 02:57:45 +0800</lastBuildDate><atom:link href="https://ttf248.life/en/tags/monitoring/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>A Complete Guide to Monitoring Linux System Metrics with the atop Tool: Installation, Configuration, and Usage</title>
        <link>https://ttf248.life/en/p/using-atop-to-monitor-linux-system-metrics-installation-configuration-and-usage-guide/</link>
        <pubDate>Thu, 06 Feb 2025 22:48:55 +0800</pubDate>
        
        <guid>https://ttf248.life/en/p/using-atop-to-monitor-linux-system-metrics-installation-configuration-and-usage-guide/</guid>
        <description>&lt;p&gt;Real-time and comprehensive monitoring of system resources and process status is crucial in Linux system maintenance. As a powerful monitoring tool, atop can help us easily achieve this goal. This article will detail how to install, configure, and use the atop monitoring tool on a Linux instance.&lt;/p&gt;
&lt;h2 id=&#34;introduction-to-atop-tool&#34;&gt;Introduction to atop tool
&lt;/h2&gt;&lt;p&gt;Atop is a tool specifically designed for monitoring Linux system resources and processes. It records system and process activity, reporting the status of all running processes. The data collected covers resource usage such as CPU, memory, disk, and network, as well as process states. This data can also be saved to disk in log file format. For each process, we can obtain key information such as CPU utilization, memory growth, disk usage, priority, username, status, and exit code. Furthermore, through the atop configuration file, we can customize parameters such as logging frequency, log file storage path, and rotation policy.&lt;/p&gt;
&lt;h2 id=&#34;ii-installing-the-atop-tool&#34;&gt;II. Installing the atop tool
&lt;/h2&gt;&lt;p&gt;The installation methods of atop vary slightly across different Linux distributions; the following introduces it using a common operating system as an example&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Alibaba Cloud Linux 3/2、CentOS 7/8、Fedora、Rocky Linux 9&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Execute installation command: &lt;code&gt;sudo yum install -y atop&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start the atop service: &lt;code&gt;sudo systemctl start atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Ubuntu / Debian&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Update software sources: &lt;code&gt;sudo apt update&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Execute the installation command: &lt;code&gt;sudo apt install -y atop&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start atop service: &lt;code&gt;sudo systemctl start atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CentOS Stream 9&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Download and install: &lt;code&gt;sudo wget https://www.atoptool.nl/download/atop-2.11.0-1.el9.x86_64.rpm &amp;amp;&amp;amp; sudo rpm -i atop-2.11.0-1.el9.x86_64.rpm&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start atop service: &lt;code&gt;sudo systemctl start atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;openSUSE&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Execute installation command: &lt;code&gt;sudo zypper install -y atop atop-daemon&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start the atop service: &lt;code&gt;sudo systemctl start atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;If the operating systems listed above do not include your distribution, you can visit the atop official website for installation information&lt;/p&gt;
&lt;h2 id=&#34;iii-configuring-monitoring-cycle-and-log-retention-time&#34;&gt;III. Configuring Monitoring Cycle and Log Retention Time
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Configuration file location: On Alibaba Cloud Linux 3/2, CentOS 7/8, and Fedora systems, the atop configuration file is /etc/sysconfig/atop; on Ubuntu, Debian, and openSUSE systems, the configuration file is /etc/default/atop&lt;/li&gt;
&lt;li&gt;Default Configuration Parameters Description
&lt;ul&gt;
&lt;li&gt;LOGOPTS: Used to control log file recording options, defaults to empty&lt;/li&gt;
&lt;li&gt;The monitoring cycle, default is 600 seconds. If you need to collect historical logs to track issues, adjust this frequency according to your actual needs.&lt;/li&gt;
&lt;li&gt;LOGGENERATIONS: Log retention time, default 28 days&lt;/li&gt;
&lt;li&gt;LOGPATH: The path where log files are stored, default /var/log/atop&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Configuration Steps
&lt;ul&gt;
&lt;li&gt;Execute the command to open the configuration file:
&lt;ul&gt;
&lt;li&gt;On Alibaba Cloud Linux 3/2, CentOS 7/8, Fedora systems: &lt;code&gt;sudo vim /etc/sysconfig/atop&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;In Ubuntu, Debian, openSUSE, CentOS Stream 9, Rocky Linux 9 systems: &lt;code&gt;sudo vim /etc/default/atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;i&lt;/code&gt; to enter edit mode and adjust configuration parameters as needed. For example, change the monitoring cycle to 30 seconds, set the log retention time to 7 days, and keep the log path at its default setting:&lt;/li&gt;
&lt;li&gt;Press the &lt;code&gt;Esc&lt;/code&gt; key, enter &lt;code&gt;:wq&lt;/code&gt;, save and exit editing&lt;/li&gt;
&lt;li&gt;Restarting the atop service will apply the configuration: &lt;code&gt;sudo systemctl restart atop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;LOGOPTS=&amp;quot;&amp;quot;
LOGINTERVAL=30
LOGGENERATIONS=7
LOGPATH=/var/log/atop 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;four-using-the-atop-tool&#34;&gt;Four, Using the atop tool
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Introduction to Common Commands: In interactive command mode, the following are common commands:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Switch back to the default composite output view&lt;/li&gt;
&lt;li&gt;Displays the full command line of processes&lt;/li&gt;
&lt;li&gt;Sort by process memory usage in descending order&lt;/li&gt;
&lt;li&gt;Sort by process disk usage in descending order&lt;/li&gt;
&lt;li&gt;Sort in descending order based on the comprehensive utilization rate of processes and resources&lt;/li&gt;
&lt;li&gt;Sort by process network usage in descending order&lt;/li&gt;
&lt;li&gt;Go to the next monitoring point&lt;/li&gt;
&lt;li&gt;Go to the previous monitoring point&lt;/li&gt;
&lt;li&gt;b: Specifies a point in time, formatted as &lt;code&gt;YYYYMMDDhhmm&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Introduction to Resource Monitoring Fields&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Host name, information sampling date and time&lt;/li&gt;
&lt;li&gt;Overall process runtime status, including kernel and user space running time, total number of processes, and the number of processes in different states&lt;/li&gt;
&lt;li&gt;The CPU utilization shows the overall usage, with each field&amp;rsquo;s numerical sum resulting in &lt;code&gt;N*100%&lt;/code&gt; (where N is the number of CPU cores), including kernel time, user time, interrupt time, idle time, and wait for disk I/O time proportions&lt;/li&gt;
&lt;li&gt;CPL: CPU load information, such as the average number of processes in the run queue over the past 1 minute, 5 minutes, and 15 minutes, context switch count, and interrupt occurrence count&lt;/li&gt;
&lt;li&gt;MEM: Memory usage, including total physical memory, idle memory, page cache memory, file cache memory, and kernel occupied memory&lt;/li&gt;
&lt;li&gt;SWP: Swap space usage, including total swap area and free swap space size&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PAG&lt;/strong&gt;: Virtual memory paging status, such as the number of pages swapped in and out&lt;/li&gt;
&lt;li&gt;DSK: Disk Usage, each disk device corresponds to a row, displaying device identifier, busy time ratio, and read/write request count&lt;/li&gt;
&lt;li&gt;NET: Network conditions, displaying receive and send packet sizes for the transport layer TCP and UDP, IP layer, and active network interfaces&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;View real-time system metrics&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check system metrics every 5 seconds: &lt;code&gt;atop 5&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Check system metrics within the next 5 minutes (total of 30 times, with a 10-second interval): &lt;code&gt;atop -M 10 30&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Check system metrics after 10 minutes (10 times, with a 60-second interval) and write the results to a file: &lt;code&gt;atop -M 60 10 &amp;gt; /log/atop.mem&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;To view historical indicator logs: After atop starts, the collection records are stored by default in the &lt;code&gt;/var/log/atop&lt;/code&gt; directory. When viewing, be sure to check that the log file for the specified date exists; otherwise, an error will occur.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;View daily history indicators log: &lt;code&gt;atop -r&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;View yesterday&amp;rsquo;s historical indicator logs: &lt;code&gt;atop -r y&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;View historical indicator logs for a specified date, such as November 6, 2024: &lt;code&gt;atop -r 20241106&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;View historical indicator logs from a specified time within a specified date, such as starting at 14:00 on November 6, 2024: &lt;code&gt;atop -r 20241106 -b 14:00&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;View the historical indicator logs for a specified time period within a specific date, such as November 5, 2024 from 00:04 to 00:08: &lt;code&gt;atop -r 20241105 -b 00:04 -e 00:08&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;View System Activity Report&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check the CPU utilization report of the current system within 1 minute (12 times, interval 5 seconds): &lt;code&gt;atopsar -c 5 12&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;To view the memory metrics report for a specified time period on that day, such as from 18:00 to 18:01: &lt;code&gt;atopsar -m -b 18:00 -e 18:01&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;View memory metrics reports for a specified date and time period, such as November 5, 2024, from 18:00 to 18:01: &lt;code&gt;atopsar -m -r 20241105 -b 18:00 -e 18:01&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;v-other-operations&#34;&gt;V. Other Operations
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Configure a Tian-level log rotation policy: If you want to generate an atop index log file every day, you can perform the following operations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(Optional) Adjust the monitoring cycle, log retention time, and log storage path as needed&lt;/li&gt;
&lt;li&gt;Run command to set daily log rotation related services to start on boot and start the services: &lt;code&gt;sudo systemctl enable --now atop atopacct atop-rotate.timer&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If the business has more complex requirements for log processing, it can be combined with logrotate or custom scripts to implement log management&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Load the optional netatop kernel module: If you need to monitor network usage, you can install the netatop module (this module is not installed by default in atop). Taking Alibaba Cloud Linux 3 as an example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Install the kernel development package and software environment required for compilation: &lt;code&gt;sudo yum install -y kernel-devel dkms elfutils-libelf-devel&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Download the latest version of netatop source code to a designated directory: &lt;code&gt;cd /usr/src/ &amp;amp;&amp;amp; sudo wget https://www.atoptool.nl/download/netatop-3.2.2.tar.gz --no-check-certificate&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Extract the source code and enter the source directory: &lt;code&gt;sudo tar -zxvf netatop-3.2.2.tar.gz &amp;amp;&amp;amp; cd netatop-3.2.2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Build and install the module and daemon from source code: &lt;code&gt;sudo make &amp;amp;&amp;amp; sudo make install&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start the netatop service: &lt;code&gt;sudo systemctl start netatop&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The atop tool is powerful and flexible. With proper installation, configuration, and usage, we can better understand the operating status of the Linux system, promptly discover and resolve potential issues. We hope this article will help everyone improve their skills in Linux system monitoring.&lt;/p&gt;
&lt;h2 id=&#34;references&#34;&gt;References
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;[atop official website]&lt;/li&gt;
&lt;li&gt;Installing, Configuring, and Using the atop Monitoring Tool&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        
    </channel>
</rss>
