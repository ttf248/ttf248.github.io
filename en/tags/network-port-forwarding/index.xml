<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Network Port Forwarding on Uncle Xiang&#39;s Notebook</title>
        <link>https://ttf248.life/en/tags/network-port-forwarding/</link>
        <description>Recent content in Network Port Forwarding on Uncle Xiang&#39;s Notebook</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <lastBuildDate>Sun, 25 May 2025 02:57:45 +0800</lastBuildDate><atom:link href="https://ttf248.life/en/tags/network-port-forwarding/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>ZeroTier local area network across locations</title>
        <link>https://ttf248.life/en/p/zero-tier-remote-lan/</link>
        <pubDate>Tue, 19 Sep 2023 04:58:03 +0800</pubDate>
        
        <guid>https://ttf248.life/en/p/zero-tier-remote-lan/</guid>
        <description>&lt;p&gt;I recently got a mini desktop for the office, thinking it would be convenient to set up an environment and occasionally access things from home. So I temporarily deployed an intranet penetration tool. Based on my past experience, I deployed the &lt;code&gt;frp&lt;/code&gt; service with port forwarding, which requires a public server – the connection quality depends on the bandwidth of that public server. Then I decided to try something new: a &lt;code&gt;Zerotier&lt;/code&gt; virtual machine local area network, similar to a &lt;code&gt;VPN&lt;/code&gt;. I created a new virtual network card locally and added all machines to a virtual network.&lt;/p&gt;
&lt;h2 id=&#34;what-is-zerotier&#34;&gt;What is ZeroTier?
&lt;/h2&gt;&lt;p&gt;ZeroTier is a software-defined wide area network (SD-WAN) solution that allows users to create secure virtual networks between devices in different geographical locations. With ZeroTier, you can easily connect multiple computers, servers, and devices into a virtual, encrypted network as if they were on the same local area network. This helps programmers and IT professionals securely share data and resources across different locations without complex network setups and VPN configurations.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Zerotier Network: Zerotier Network is a virtual, global local area network that allows different devices to connect together over the internet as if they were on the same physical network. This network can contain multiple subnets, and all devices are connected through Zerotier&amp;rsquo;s technology.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Planet servers are one of the key components of the Zerotier network. They are global and responsible for maintaining and managing the topology, routing information, and network status of the entire Zerotier network. Planet servers act as a global network control center but do not directly transmit data. User devices need to connect to at least one planet server to participate in the Zerotier network.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Relay servers are auxiliary nodes in the Zerotier network, used to help devices establish direct communication channels. When devices cannot connect directly, they can transmit data through relay servers. This helps improve network reachability and performance. Relay servers are typically located around the world, acting as transit points for data transmission.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Overall, Zerotier uses planetary and relay servers to enable devices to create a virtual local area network globally, achieving secure and fast communication between devices. Planetary servers are responsible for global network management, while relay servers help devices establish communication connections when needed.&lt;/p&gt;
&lt;h2 id=&#34;installation-and-deployment&#34;&gt;Installation and deployment
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Visit the ZeroTier official website (&lt;a class=&#34;link&#34; href=&#34;https://www.zerotier.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zerotier.com/&lt;/a&gt;) to obtain installation files and documentation&lt;/li&gt;
&lt;li&gt;Download and install the ZeroTier One client according to your operating system. It supports Windows, macOS, Linux, and many other platforms.&lt;/li&gt;
&lt;li&gt;After installation, start the ZeroTier One client&lt;/li&gt;
&lt;li&gt;Register a ZeroTier account, if you don&amp;rsquo;t already have one. You can create an account within the client.&lt;/li&gt;
&lt;li&gt;Log in to your ZeroTier account and create a new network. The network will have a unique 16-character ID that you need to remember.&lt;/li&gt;
&lt;li&gt;Join this network on your device. You can enter the network ID in the client or use the QR code scanning function.&lt;/li&gt;
&lt;li&gt;Devices installed with and configured with the ZeroTier client will be added to the same virtual network. These devices can now communicate directly as if they were on the same local area network.&lt;/li&gt;
&lt;li&gt;You can manage network settings, add devices, and monitor network traffic in ZeroTier&amp;rsquo;s control panel&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;install-and-deploy-moon&#34;&gt;Install and deploy Moon
&lt;/h2&gt;&lt;p&gt;Many domestic carriers prohibit UDP tunneling, but frp service is stable. Because it uses the TCP protocol, a similar effect can be achieved by deploying a Zerotier relay server. The firewall needs to open udp 9993.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;curl -s https://install.zerotier.com/ | sudo bash
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Check if the installation was successful&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli info
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Join the local area network&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli join network-id
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create &lt;code&gt;moon&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;cd /var/lib/zerotier-one &amp;amp;&amp;amp; sudo zerotier-idtool initmoon identity.public &amp;gt; moon.json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Edit the configuration file, adjust the &lt;code&gt;stableEndpoints&lt;/code&gt; node, &amp;ldquo;public IP address of the server/9993&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Generate signature configuration, create a &lt;code&gt;moons.d&lt;/code&gt; folder, move the previous files into it, and restart the service&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo zerotier-idtool genmoon moon.json
mkdir moons.d &amp;amp;&amp;amp; mv 000000eb444ec0d8.moon moons.d/
systemctl restart zerotier-one.service
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Client nodes join the Moon server; their ID is taken from the ID field in the preceding JSON configuration file&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli.bat orbit ztaddr ztaddr
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# 观察是否出现新的 mooon 节点，id 和信息为服务器配置的相同
[root@idv-36f9d5 ~]# zerotier-cli listpeers
200 listpeers &amp;lt;ztaddr&amp;gt; &amp;lt;path&amp;gt; &amp;lt;latency&amp;gt; &amp;lt;version&amp;gt; &amp;lt;role&amp;gt;
200 listpeers 0cccb***** 35.236.*.*/64393;110;10726 327 1.6.3 LEAF
200 listpeers 3a46f***** 185.180.*.*/9993;110;757 -1 - PLANET
200 listpeers 3ed7c***** 39.97.*.*/9993;172;79 32 1.6.3 MOON
200 listpeers 4f838***** - -1 - LEAF
200 listpeers 62f86***** 50.7.*.*/9993;110;4796 351 - PLANET
200 listpeers 778cd***** 103.195.*.*/9993;5148;4887 253 - PLANET
200 listpeers 992fc***** 195.181.*.*/9993;10161;4921 226 - PLANET
200 listpeers 9d2b5***** - -1 - LEAF
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;On Windows, launch the terminal with administrator privileges and use the zerotier-cli.bat command-line tool; on Linux, use the zerotier-cli command. The peers subcommand shows connections, listpeers displays all nodes, and successful joining is indicated by the normal display of the &lt;code&gt;moon&lt;/code&gt; node.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;how-to-uninstall&#34;&gt;How to uninstall
&lt;/h2&gt;&lt;p&gt;There&amp;rsquo;s no need to elaborate on how to uninstall software on Windows; it’s a standard procedure that can be done through the Control Panel. We will focus on Ubuntu instead.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Remove the zerotier-one service using dpkg&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo dpkg -P zerotier-one
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Delete the zerotier-one folder, which stores the address; deleting it and reinstalling will obtain a new address&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo rm -rf /var/lib/zerotier-one/
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;afterword&#34;&gt;Afterword
&lt;/h2&gt;&lt;p&gt;They were all already uninstalled. When the server arrived, there weren&amp;rsquo;t any suitable services available as proxy nodes. Aliyun, pushing for performance, offered developer-exclusive servers with modest configurations at a reasonable price of 99 yuan per year. We used them for two years, primarily because of the bandwidth the servers provided.&lt;/p&gt;
&lt;h2 id=&#34;reference-materials&#34;&gt;Reference materials
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.wnark.com/archives/152.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.wnark.com/archives/152.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/Yogile/p/12642423.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.cnblogs.com/Yogile/p/12642423.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        
    </channel>
</rss>
