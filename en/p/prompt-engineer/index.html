<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Just as we needed to learn the techniques of searching engines back then, we also need to learn some techniques for communicating with AI, providing reasonable and sufficient constraints, and efficiently obtaining the answers we need. If you look at it from a different angle, current AI is like a very good student with excellent memory – it has the ability to memorize everything. What we need to do is">
<title>Prompt Engineer</title>

<link rel='canonical' href='https://ttf248.life/en/p/prompt-engineer/'>

<link rel="stylesheet" href="/scss/style.min.a2714c9632013309acc13e941c4a637a771eba1d2e2e25f24d7bda75c48da2d2.css"><meta property='og:title' content="Prompt Engineer">
<meta property='og:description' content="Just as we needed to learn the techniques of searching engines back then, we also need to learn some techniques for communicating with AI, providing reasonable and sufficient constraints, and efficiently obtaining the answers we need. If you look at it from a different angle, current AI is like a very good student with excellent memory – it has the ability to memorize everything. What we need to do is">
<meta property='og:url' content='https://ttf248.life/en/p/prompt-engineer/'>
<meta property='og:site_name' content='Uncle Xiang&#39;s Notebook'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='chatgtp' /><meta property='article:tag' content='ai' /><meta property='article:published_time' content='2023-03-26T20:46:53&#43;08:00'/><meta property='article:modified_time' content='2025-06-02T20:54:02&#43;08:00'/>
<meta name="twitter:title" content="Prompt Engineer">
<meta name="twitter:description" content="Just as we needed to learn the techniques of searching engines back then, we also need to learn some techniques for communicating with AI, providing reasonable and sufficient constraints, and efficiently obtaining the answers we need. If you look at it from a different angle, current AI is like a very good student with excellent memory – it has the ability to memorize everything. What we need to do is">
    <link rel="shortcut icon" href="/favicon-16x16.png" />

  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-73CVP7MPC8"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-73CVP7MPC8');
        }
      </script>
    
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/en">Uncle Xiang&#39;s Notebook</a></h1>
            <h2 class="site-description">Collecting Moments, Marking Time</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/ttf248'
                        target="_blank"
                        title="0-GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='mailto:tianlong.xiang@foxmail.com'
                        target="_blank"
                        title="Email"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='/index.xml'
                        target="_blank"
                        title="RSS"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="5" cy="19" r="1" />
  <path d="M4 4a16 16 0 0 1 16 16" />
  <path d="M4 11a9 9 0 0 1 9 9" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/notes/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-pen-icon lucide-square-pen"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"/></svg>
                
                <span>随记</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">
                    
                        <li id="i18n-switch">  
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                            <select name="language" title="language" onchange="window.location.href = this.selectedOptions[0].value">
                                
                                    <option value="https://ttf248.life/" >中文</option>
                                
                                    <option value="https://ttf248.life/en/" selected>English</option>
                                
                                    <option value="https://ttf248.life/ja/" >日本語</option>
                                
                            </select>
                        </li>
                    
                

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#does-it-really-have-intelligence">Does it Really Have Intelligence?</a></li>
    <li><a href="#prompt-engineer">Prompt Engineer</a></li>
    <li><a href="#dialogue-patterns">Dialogue Patterns</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/github-dark.min.css">


<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js"></script>

<style>
:root {
    --copy-btn-bg: #4CAF50;
    --copy-btn-hover-bg: #45a049;
    --copy-btn-success-bg: #2196F3;
    --copy-btn-text-color: #ffffff;
    --copy-btn-border-radius: 6px;
    --copy-btn-transition: all 0.3s ease;
}

.code-container {
    position: relative;
    margin: 1rem 0;
}

.code-container pre {
    margin: 0;
    border-radius: var(--copy-btn-border-radius);
    overflow-x: auto;
}

.copy-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    padding: 6px 12px;
    background: var(--copy-btn-bg);
    color: var(--copy-btn-text-color);
    border: none;
    border-radius: var(--copy-btn-border-radius);
    cursor: pointer;
    font-size: 0.85em;
    font-weight: 500;
    transition: var(--copy-btn-transition);
    z-index: 10;
    opacity: 0.8;
}

.copy-btn:hover {
    background: var(--copy-btn-hover-bg);
    opacity: 1;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.copy-btn:active {
    transform: translateY(0);
}

.copy-btn.copied {
    background: var(--copy-btn-success-bg);
}

.copy-btn:focus {
    outline: 2px solid var(--copy-btn-success-bg);
    outline-offset: 2px;
}

 
@media (max-width: 768px) {
    .copy-btn {
        font-size: 0.8em;
        padding: 4px 8px;
        top: 4px;
        right: 4px;
    }
}

 
.code-container:hover .copy-btn {
    opacity: 1;
}
</style>

<script>
class CodeCopyManager {
    constructor() {
        this.initializeHighlighting();
        this.addCopyButtons();
    }

    initializeHighlighting() {
        document.querySelectorAll('pre code').forEach((block) => {
            hljs.highlightElement(block);
        });
    }

    addCopyButtons() {
        document.querySelectorAll('pre code').forEach((block) => {
            this.createCopyButton(block);
        });
    }

    createCopyButton(codeBlock) {
        const preElement = codeBlock.parentNode;
        
        
        if (preElement.parentNode.classList.contains('code-container')) {
            return;
        }

        const container = this.createContainer(preElement);
        const button = this.createButton();
        
        container.appendChild(button);
        
        button.addEventListener('click', () => this.handleCopy(button, codeBlock));
    }

    createContainer(preElement) {
        const container = document.createElement('div');
        container.classList.add('code-container');
        
        preElement.parentNode.insertBefore(container, preElement);
        container.appendChild(preElement);
        
        return container;
    }

    createButton() {
        const button = document.createElement('button');
        button.classList.add('copy-btn');
        button.innerText = '复制代码';
        button.setAttribute('aria-label', '复制代码到剪贴板');
        return button;
    }

    async handleCopy(button, codeBlock) {
        try {
            const code = codeBlock.innerText;
            await navigator.clipboard.writeText(code);
            this.showCopySuccess(button);
        } catch (error) {
            console.error('复制失败:', error);
            this.showCopyError(button);
        }
    }

    showCopySuccess(button) {
        const originalText = button.innerText;
        button.innerText = '已复制';
        button.classList.add('copied');
        
        setTimeout(() => {
            button.innerText = originalText;
            button.classList.remove('copied');
        }, 2000);
    }

    showCopyError(button) {
        const originalText = button.innerText;
        button.innerText = '复制失败';
        
        setTimeout(() => {
            button.innerText = originalText;
        }, 2000);
    }
}

document.addEventListener('DOMContentLoaded', () => {
    new CodeCopyManager();
});
</script>

<div class="article-details">
    
    <header class="article-category">
        
            <a href="/en/categories/computer/" >
                Computer
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/en/p/prompt-engineer/">Prompt Engineer</a>
        </h2>
    
        

        
        <h5 class="article-summary" style="display: none;">Just as we needed to learn the techniques of searching engines back then, we also need to learn some techniques for communicating with AI, providing reasonable and sufficient constraints, and efficiently obtaining the answers we need. If you look at it from a different angle, current AI is like a very good student with excellent memory – it has the ability to memorize everything. What we need to do is</h5>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                if (typeof isHomepage !== 'undefined' && isHomepage === true) {
                    document.querySelectorAll(".article-summary").forEach(function(element) {
                        element.style.display = "block";
                    });
                }
            });
        </script>
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 26, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    

    
        <footer class="article-translations">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



            <div>
                
                    <a href="https://ttf248.life/p/prompt-engineer/" class="link">中文</a>
                
                    <a href="https://ttf248.life/ja/p/prompt-engineer/" class="link">日本語</a>
                
            </div>
        </footer>
    
</div>
</header>

    <section class="article-content">
    
    
    <p>Just as we needed to learn the techniques of searching engines back then, we also need to learn some techniques for communicating with <code>AI</code>, providing reasonable and sufficient constraints, and efficiently obtaining the answers we need.</p>
<p>If you look at it from a different angle, current <code>AI</code> is like a very good student with excellent memory – it has the ability to memorize everything. What we need to do is learn how to communicate with <code>AI</code> correctly, effectively, and precisely describe our needs to help <code>AI</code> generate the expected results.</p>
<p>##科普
The incredibly popular <code>AI</code> – specifically <code>Generative Pre-Training</code> – literally translates to generative pre-training. It’s a deep learning model that trains text generation based on internet-available data, used for tasks like question answering, text summarization generation, machine translation, classification, code generation, and conversational AI. Currently, there have been various versions of models such as GPT-1, GPT-2, GPT-3, and GPT-4, each larger and more powerful than the previous one.</p>
<h2 id="does-it-really-have-intelligence">Does it Really Have Intelligence?
</h2><ul>
<li>Similarity is high, accuracy increases accordingly.</li>
<li>Basic, repetitive tasks, after specific training, no longer require human intervention.</li>
</ul>
<p>Generative AI is a technology that utilizes existing data such as text, audio, and images to create new content. It can be used for various tasks including text generation, speech synthesis, image generation, and dialogue systems. The logical reasoning of Generative AI depends on its training data and model structure. Generally, Generative AI can follow grammar, logic, and common sense to a certain extent, but it may also produce errors, biases, or unrealistic content. Therefore, the output of Generative AI requires human judgment and verification; it should not be blindly trusted or used.</p>
<h2 id="prompt-engineer">Prompt Engineer
</h2><p>Time flows only forward, and people need to learn to adapt to the current. You can think of <code>AI</code> as not intelligent, lacking logic, and often producing unusable code.</p>
<p>If you shift your perspective, the current <code>AI</code> is like a child with excellent memory – it has the ability to memorize after reading something repeatedly, much like copying homework. What we need to do is learn how to communicate correctly, effectively, and with <code>AI</code>, precisely describing our needs to help <code>AI</code> generate the desired results.</p>
<h2 id="dialogue-patterns">Dialogue Patterns
</h2><p>Two years ago, when GitHub Copilot was released, no one could have imagined that two years later, OpenAI would appear out of nowhere, allowing humans to recognize the capabilities of large language models.</p>
<p>Based on <strong>comment-based programming</strong> and <strong>conversational programming</strong>, the interaction logic is completely different. The dialogue pattern is friendly for novice users, and it’s necessary to mention NewBing providing follow-up prompts after each question. Microsoft is trying to guide users to obtain more content from the AI knowledge base.</p>
<ul>
<li>Example Scenario
<strong>Scene:</strong> A long high-speed train journey, coding is a good choice. With limited traffic, processing a few images, obtaining image materials, downloading software to process images is a bit extravagant, and network conditions don’t allow it.
<strong>Requirement:</strong> There are a batch of picture materials with transparent background images used as navigation bars for small programs. The selected state is colored, and the unselected state is black and white. The materials are all in color, and they need to be preprocessed.
<strong>Prompt:</strong> Write a python code snippet to read all pictures from a folder, convert the pictures into black and white, maintain the transparent background, save the pictures, optimize the image quality, reduce file size, and display it in the console, comparing the sizes before and after optimization.</li>
</ul>
<pre><code class="language-python"># Import necessary libraries
import os
from PIL import Image

# Define a function to convert images to black and white, maintain transparency, save images, and return file sizes
def convert_and_save(image_file):
    # Open the image
    image = Image.open(image_file)
    # Get the image mode, if it's RGBA mode, indicating a transparent background
    mode = image.mode
    if mode == &quot;RGBA&quot;:
        # Create a white background image with the same size as the original image
        background = Image.new(&quot;RGB&quot;, image.size, (255, 255, 255))
        # Paste the original image onto the white background, ignoring transparent pixels
        background.paste(image, mask=image.split()[3])
        # Convert the composite image to grayscale mode
        gray_image = background.convert(&quot;L&quot;)
        # Convert the grayscale image back to RGBA mode to preserve transparency
        final_image = gray_image.convert(&quot;RGBA&quot;)
    else:
        # If it's not RGBA mode, directly convert the image to grayscale mode
        final_image = image.convert(&quot;L&quot;)
    # Get the original image file name and extension
    file_name, file_ext = os.path.splitext(image_file)
    # Define the new image file name with _bw suffix for black and white
    new_file_name = file_name + &quot;_bw&quot; + file_ext
    # Save the new image and optimize quality, reduce file size
    final_image.save(new_file_name, optimize=True)
    # Get the original and new image file sizes and return
    old_size = os.path.getsize(image_file)
    new_size = os.path.getsize(new_file_name)
    return old_size, new_size

# Define a folder path to store all images
folder_path = &quot;images&quot;
# Iterate through all files in the folder
for file in os.listdir(folder_path):
    # Concatenate the full file path
    file_path = os.path.join(folder_path, file)
    # Check if the file is an image file based on extension (can add or modify extensions as needed)
    if file_path.endswith((&quot;.png&quot;, &quot;.jpg&quot;, &quot;.jpeg&quot;, &quot;.gif&quot;)):
        # Call the function to convert and save the image, and get the file size
        old_size, new_size = convert_and_save(file_path)
        # Display the comparison of file sizes before and after optimization in the console
        print(f&quot;{file}: {old_size} bytes -&gt; {new_size} bytes&quot;)
</code></pre>
<p><code>AI</code> quickly provided an answer, looked very beautiful, and worked well, experienced programmers would find that the code below was not very generic, and couldn’t be put into production:</p>
<ul>
<li>Fixed parameters</li>
<li>No log files, all information is printed to the console</li>
<li>The task of image processing is suitable for a multi-threaded model
<code>NewBing</code> appeared, based on the prompt, chose a question: <strong>What can be improved in this code?</strong>
The answer given this time was far beyond expectations, and most programmers would think of optimization measures, <code>AI</code> gave corresponding suggestions.</li>
</ul>
<pre><code class="language-shell">This code may still have some improvements, such as:

You can use the argparse library to allow users to specify the folder path and extension through command-line parameters instead of hardcoding them in the code.
You can use the logging library to record the running status of the program instead of printing it directly to the console.
You can use try-except statements to catch potential exceptions, such as file opening failure, image conversion failure, etc., and handle them

## Let's illustrate with an example

```python
# Import necessary libraries
import argparse
import logging
import multiprocessing
import os

from PIL import Image


# Define a function to convert and save the image, maintaining transparent background and optimizing file size
def convert_and_save(image_file):
    # Open the image
    try:
        image = Image.open(image_file)
    except Exception as e:
        logging.error(f&quot;Failed to open {image_file}: {e}&quot;)
        return None, None
    # Get the image mode; if it's RGBA, it has a transparent background
    mode = image.mode
    if mode == &quot;RGBA&quot;:
        # Create a white background image with the same size
        background = Image.new(&quot;RGB&quot;, image.size, (255, 255, 255))
        # Paste the original image onto the white background, ignoring transparent pixels
        background.paste(image, mask=image.split()[3])
        # Convert the combined image to grayscale mode
        gray_image = background.convert(&quot;L&quot;)
        # Convert the grayscale image back to RGBA mode to preserve the transparent background
        final_image = gray_image.convert(&quot;RGBA&quot;)
    else:
        # If it's not RGBA, directly convert the image to grayscale mode
        final_image = image.convert(&quot;L&quot;)
    # Get the original image file name and extension
    file_name, file_ext = os.path.splitext(image_file)
    # Define the new image file name with _bw suffix for black and white
    new_file_name = file_name + &quot;_bw&quot; + file_ext
    # Save the new image, optimizing quality to reduce file size
    try:
        final_image.save(new_file_name, optimize=True)
    except Exception as e:
        logging.error(f&quot;Failed to save {new_file_name}: {e}&quot;)
        return None, None
    # Get the original image and new image file sizes, and return
    old_size = os.path.getsize(image_file)
    new_size = os.path.getsize(new_file_name)
    return file_name, old_size, new_size

# Define a function to parse command-line arguments and return the folder path and extension list
def parse_args():
    # Create an argument parser object
    parser = argparse.ArgumentParser(description=&quot;Convert images to black and white and optimize quality.&quot;)
    # Add a required positional argument, representing the folder path
    parser.add_argument(&quot;folder_path&quot;, help=&quot;The path of the folder that contains the images.&quot;)
    # Add an optional argument, representing the extension list, defaulting to png, jpg, jpeg, and gif
    parser.add_argument(&quot;-e&quot;, &quot;--extensions&quot;, nargs=&quot;+&quot;, default=[&quot;.png&quot;, &quot;.jpg&quot;, &quot;.jpeg&quot;, &quot;.gif&quot;], help=&quot;The extensions of the image files.&quot;)
    # Parse command-line arguments and return the result object
    args = parser.parse_args()
    return args.folder_path, args.extensions

# Define a function to print the comparison of file sizes before and after optimization
def print_result(result):
    # If the result is not empty, indicating successful conversion and saving
    if result:
        # Unpack the result into a tuple of filename and file size tuple
        if len(result) == 3:
            file, old_size, new_size = result
            # Display the comparison of file sizes before and after optimization in the console
            logging.info(f&quot;{file}: {old_size} bytes -&gt; {new_size} bytes&quot;)
        else:
            # Log the result if it's not a tuple of 3 elements
            logging.info(f&quot;{result}&quot;)

# Configure the logger, outputting logs to the console and files, setting the log level to INFO
logging.basicConfig(level=logging.INFO,
                    format=&quot;%(asctime)s %(levelname)s %(message)s&quot;,
                    handlers=[logging.StreamHandler(),
                              logging.FileHandler(&quot;log.txt&quot;)])

# Call the function to get the folder path and extension list
folder_path, extensions = parse_args()

if __name__ == &quot;__main__&quot;:
    # Windows needs this function because Windows lacks the fork() function (not entirely accurate).
    # Therefore, on Windows, forking is simulated by creating a new process, and the code - Additionally, this new process is instructed to run the code passed through a pipe by passing the `--multiprocessing-fork` command-line argument to it.
- If you examine the implementation of the `freeze_support()` function, its task is to check which process it's running in and whether it should execute the code passed through a pipe.
- `multiprocessing.freeze_support()`

- A process pool is created, automatically allocating processes based on the number of cores on the computer.
- An empty list, `results`, is created to store the result objects of asynchronous tasks.
- The script iterates through all files in the folder:
- The full file path is constructed using `os.path.join()`.
- It checks if the file ends with any of the extensions specified in the `extensions` list (you can modify this list as needed).
- If it's an image file, the `convert_and_save` function is called to convert and save the image asynchronously, without blocking the main process. The file size is also obtained.  The result object is then added to the `results` list using `pool.apply_async()` with the callback function `print_result`.
- The process pool is closed to stop accepting new tasks.
- `pool.join()` is called to wait for all tasks in the pool to complete.

## Epilogue
Due to local development being on a `windows` system, the first answer given by `AI` did not include the `main` function and also lacked `multiprocessing.freeze_support`. The code was fixed after following up and encountering an error. 
Just as learning the techniques of search engines required skill, we also need to learn how to communicate with `AI`, providing reasonable and sufficient constraints to efficiently obtain the desired answers.
Note: **If you are a programming beginner, if you still don't understand certain parts of the code based on the given comments, please continue to ask related questions.**</code></pre>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/en/tags/chatgtp/">Chatgtp</a>
        
            <a href="/en/tags/ai/">Ai</a>
        
    </section>


    <section class="article-author">
        <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="currentColor"  class="icon icon-tabler icons-tabler-filled icon-tabler-user"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 2a5 5 0 1 1 -5 5l.005 -.217a5 5 0 0 1 4.995 -4.783z" /><path d="M14 14a5 5 0 0 1 5 5v1a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-1a5 5 0 0 1 5 -5h4z" /></svg>
        <span>
            
                tianlong.xiang
            
        </span>
    </section>

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>
            
                Licensed under CC BY-NC-SA 4.0
            
        </span>
    </section>
    

    
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Jun 02, 2025 20:54
        </span>
    </section>
    
    
</footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/en/p/all-the-gifts-of-ai-have-already-been-marked-up-with-prices-in-the-shadows/">
        
        

        <div class="article-details">
            <h2 class="article-title">All the gifts of AI have already been marked up with prices in the shadows.</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/en/p/bytedance-ais-solo-encoding-new-paradigm/">
        
        

        <div class="article-details">
            <h2 class="article-title">ByteDance AI’s SOLO encoding new paradigm</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/en/p/recent-usage-experiences-of-large-models/">
        
        

        <div class="article-details">
            <h2 class="article-title">Recent Usage Experiences of Large Models</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/en/p/blog-translation-project-musings-cultural-transmission-ai-programming/">
        
        

        <div class="article-details">
            <h2 class="article-title">Blog Translation Project Musings: Cultural Transmission, AI Programming</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/en/p/blog-translation-project-musings-historical-conversations/">
        
        

        <div class="article-details">
            <h2 class="article-title">Blog Translation Project Musings: Historical Conversations</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2025 Uncle Xiang&#39;s Notebook
    </section>
    
    <section class="powerby">
        
            A financial IT programmer's tinkering and daily life musings <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
