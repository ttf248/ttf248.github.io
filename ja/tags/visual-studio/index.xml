<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Visual Studio on 向叔の手帳</title>
        <link>https://ttf248.life/ja/tags/visual-studio/</link>
        <description>Recent content in Visual Studio on 向叔の手帳</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ja</language>
        <lastBuildDate>Mon, 02 Jun 2025 19:00:25 +0800</lastBuildDate><atom:link href="https://ttf248.life/ja/tags/visual-studio/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Visual Studio が「不整合な」PDB ファイルを読み込みません。</title>
        <link>https://ttf248.life/ja/p/visual-studio-load-unmatched-pdb/</link>
        <pubDate>Thu, 23 Jan 2025 20:04:33 +0800</pubDate>
        
        <guid>https://ttf248.life/ja/p/visual-studio-load-unmatched-pdb/</guid>
        <description>&lt;p&gt;WindowsでVisual Studioを使ってプログラムをデバッグする場合、PDBファイルと実行可能ファイルが一致しない場合、Visual Studioは「シンボルファイルを読み込めません」というエラーを表示します。プログラムの実行中にクラッシュが発生し、ダンプファイルが生成された場合、不一致なPDBファイルの場合、Visual Studioはクラッシュ現場にスムーズに入ることができません。&lt;/p&gt;
&lt;h2 id=&#34;pdb-ファイルとは&#34;&gt;PDB ファイルとは
&lt;/h2&gt;&lt;p&gt;PDB ファイルは、Microsoft が提供するデバッグ情報ファイルで、プログラムのデバッグに使用されます。PDB ファイルには、シンボルテーブル、ソースコードファイル名、行番号などの情報が含まれています。プログラムをコンパイルするときに生成され、プログラムのデバッグに使用されます。&lt;/p&gt;
&lt;h2 id=&#34;windbg-デバッグ&#34;&gt;WinDbg デバッグ
&lt;/h2&gt;&lt;p&gt;WinDbg は Microsoft 製のデバッガで、Windows プログラムをデバッグするために使用されます。WinDbg は不一致な PDB ファイルをロードできますが、手動でロードする必要があります。.reload /f /i コマンドを使用して、強制的に不一致な PDB ファイルをロードできます。
しかし、WinDbg の使い勝手は Visual Studio ほど簡単ではないため、Visual Studio も不一致な PDB ファイルをロードできるようにしたいと考えています。&lt;/p&gt;
&lt;h2 id=&#34;visual-studio-が-pdb-ファイルを読み込めない&#34;&gt;Visual Studio が PDB ファイルを読み込めない
&lt;/h2&gt;&lt;p&gt;ソースコードは現在、Git などのバージョン管理システムで管理されることが一般的であり、対応するバージョンのコードを再コンパイルして、対応する PDB ファイルを生成できます。なぜ読み込めないのでしょうか？主な原因は、メタデータの不一致です。&lt;/p&gt;
&lt;p&gt;元データを修正し、EXE ファイルの情報に基づいて新しい PDB ファイルを生成することで、Visual Studio がファイルを読み込めるようになります。&lt;/p&gt;
&lt;p&gt;chkmatch ダウンロード先: &lt;a class=&#34;link&#34; href=&#34;https://www.debuginfo.com/tools/chkmatch.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.debuginfo.com/tools/chkmatch.html&lt;/a&gt;
サイトのキャッシュアドレス: &lt;a class=&#34;link&#34; href=&#34;chkmatch.zip&#34; &gt;chkmatch.zip&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;visual-studio-での-pdb-ファイルの不一致&#34;&gt;Visual Studio での PDB ファイルの不一致
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ChkMatch&lt;/code&gt; ユーティリティを使用して、実行可能ファイルとデバッグ情報ファイルの互換性を確認できます。また、互換性のある実行可能ファイルとデバッグ情報ファイルを強制的に一致させることも可能です。&lt;/p&gt;
&lt;p&gt;デバッグ情報ファイルの互換性と関連する問題に関する詳細については、こちらの記事を参照してください。&lt;/p&gt;
&lt;p&gt;サポートされているデバッグ情報形式: DBG, PDB 2.0, PDB 7.0&lt;/p&gt;
&lt;h2 id=&#34;visual-studio-が-pdb-ファイルを読み込めない-1&#34;&gt;Visual Studio が PDB ファイルを読み込めない
&lt;/h2&gt;&lt;p&gt;サポートされているデバッグ情報形式: DBG, PDB 2.0, PDB 7.0。&lt;/p&gt;
&lt;p&gt;chkmatch [-c ExeFile DebugInfoFile ] |
[-m ExeFile DebugInfoFile]&lt;/p&gt;
&lt;p&gt;-c
実行ファイルとデバッグ情報ファイルの間のマッチングを確認します。
-m
実行ファイルとデバッグ情報ファイルをマッチングさせます。
ExeFile
実行ファイルの名前。
DebugInfoFile
デバッグ情報ファイルの名前。&lt;/p&gt;
&lt;h2 id=&#34;chkmatch-の使用&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;まず、照合操作を実行し、不一致の原因を分析して、署名が一致しないことを示します。&lt;/p&gt;
&lt;h2 id=&#34;chkmatch&#34;&gt;chkmatch
&lt;/h2&gt;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;C:\Users\tianlong.xiang\Downloads\chkmatch&amp;gt;ChkMatch.exe -c &amp;quot;D:\Program Files\Rolan\trade\UAT_YinStrade\YinTrade.Main.exe&amp;quot; E:\YinTech\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\bin\Release\YinTrade.Main.pdb
ChkMatch - version 1.0
Copyright (C) 2004 Oleg Starodumov
http://www.debuginfo.com/


Executable: D:\Program Files\Rolan\trade\UAT_YinStrade\YinTrade.Main.exe
Debug info file: E:\YinTech\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\bin\Release\YinTrade.Main.pdb
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;chkmatch-の使用-1&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;実行可能ファイル：
TimeDateStamp：c26d9be3
デバッグ情報：2 ( CodeView )
TimeStamp：f86b0a4f　特性：0  MajorVer：0  MinorVer：0
サイズ：122  RVA：001cdc44  ファイルオフセット：001cbe44
CodeView 形式：RSDS
署名：{428c9b95-39a3-4a8d-a8e5-7be453684757}　年齢：1
PdbFile：D:\stock_UAT\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\obj\Release\YinTrade.Main.pdb
デバッグ情報：16 ( Unknown )
TimeStamp：00000000　特性：0  MajorVer：0  MinorVer：0
サイズ：0  RVA：00000000  ファイルオフセット：00000000&lt;/p&gt;
&lt;h2 id=&#34;chkmatch-の使用-2&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;デバッグ情報ファイル：
形式：PDB 7.00
署名：{06fae08e-c0a2-4f3d-9c7c-dfc684445dd1}  バージョン：1&lt;/p&gt;
&lt;p&gt;結果：マッチングなし (理由：署名の不一致)&lt;/p&gt;
&lt;h2 id=&#34;chkmatch-の使用-3&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;その後、pdb ファイルと exe ファイルを一致するように修正操作を実行します。&lt;/p&gt;
&lt;h2 id=&#34;chkmatch-1&#34;&gt;chkmatch
&lt;/h2&gt;&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;C:\Users\tianlong.xiang\Downloads\chkmatch&amp;gt;ChkMatch.exe -m &amp;quot;D:\Program Files\Rolan\trade\UAT_YinStrade\YinTrade.Main.exe&amp;quot; E:\YinTech\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\bin\Release\YinTrade.Main.pdb
ChkMatch - version 1.0
Copyright (C) 2004 Oleg Starodumov
http://www.debuginfo.com/


Executable: D:\Program Files\Rolan\trade\UAT_YinStrade\YinTrade.Main.exe
Debug info file: E:\YinTech\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\bin\Release\YinTrade.Main.pdb
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;chkmatch-の使用-4&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;実行可能ファイル：
TimeDateStamp：c26d9be3
デバッグ情報：2 ( CodeView )
TimeStamp：f86b0a4f　特性：0  MajorVer：0  MinorVer：0
サイズ：122  RVA：001cdc44  ファイルオフセット：001cbe44
CodeView 形式：RSDS
署名：{428c9b95-39a3-4a8d-a8e5-7be453684757}　年齢：1
PdbFile：D:\stock_UAT\ykcz_securities_trading_client\Sec_Trade\YinTrade.Main\obj\Release\YinTrade.Main.pdb
デバッグ情報：16 ( Unknown )
TimeStamp：00000000　特性：0  MajorVer：0  MinorVer：0
サイズ：0  RVA：00000000  ファイルオフセット：00000000&lt;/p&gt;
&lt;h2 id=&#34;chkmatch-の使用-5&#34;&gt;chkmatch の使用
&lt;/h2&gt;&lt;p&gt;デバッグ情報ファイル：
形式：PDB 7.00
署名：{06fae08e-c0a2-4f3d-9c7c-dfc684445dd1} 年齢：1&lt;/p&gt;
&lt;p&gt;デバッグ情報ファイルへの書き込み…
結果：成功。&lt;/p&gt;
&lt;h2 id=&#34;参考資料&#34;&gt;参考資料
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://stackoverflow.com/questions/38147487/forcing-to-load-unmatched-symbols-in-visual-studio-2015-debugger&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;forcing-to-load-unmatched-symbols-in-visual-studio-2015-debugger&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>Visual Studio コンパイル文字セット [転送]</title>
        <link>https://ttf248.life/ja/p/visual-studio-character-set/</link>
        <pubDate>Thu, 04 Aug 2022 10:51:43 +0800</pubDate>
        
        <guid>https://ttf248.life/ja/p/visual-studio-character-set/</guid>
        <description>&lt;p&gt;C++をクロスプラットフォームで開発する際、中国のオペレーティングシステムではよく遭遇するエラーは、&lt;code&gt;error C2001&lt;/code&gt;（定数に改行文字が含まれています）です。&lt;/p&gt;
&lt;h2 id=&#34;visual-studio&#34;&gt;Visual Studio
&lt;/h2&gt;&lt;p&gt;CMakeはプロジェクトのコンパイルスクリプトを組織し、Windows環境での開発時に一時的にソリューションファイルを生成します。クロスプラットフォームである理由として、ファイルエンコーディングにUTF-8を選択しています。&lt;/p&gt;
&lt;p&gt;引用資料では、問題の原因について原理に基づき詳細な説明を提供しています。&lt;/p&gt;
&lt;p&gt;エンコーディングに関して、MSVCにはコンパイルオプション&lt;code&gt;/source-charset&lt;/code&gt;と&lt;code&gt;/execution-charset&lt;/code&gt;があり、前者はファイルのエンコーディングを、後者はコンパイル後のバイトコードのエンコーディングを指定します。これらのオプションを使用することで、エンコーディングの問題は基本的に解決できます。&lt;/p&gt;
&lt;p&gt;例えば、WindowsのcmdコマンドプロンプトがデフォルトでGBKエンコーディングしか表示できない場合でも、ソースファイル自体がUTF-8であるため、クロスプラットフォームであることと、直接GBKに変更することの不便さから、異なるプラットフォーム向けのエンコーディング変換コードを書くという方法も採用されません。 Windows 10 では、これらのコンパイルオプションを &lt;code&gt;/source-charset:utf-8 /execution-charset:gbk&lt;/code&gt; に設定することで、コンパイラが UTF-8 エンコーディングでソースコードを読み込み、その後 GBK エンコーディングで配列に保存します。これにより、直接 &lt;code&gt;printf&lt;/code&gt; を使用して cmd コントロールパネルで漢字を表示できます。&lt;/p&gt;
&lt;h2 id=&#34;visual-studio-用の-cmake-設定&#34;&gt;Visual Studio 用の CMake 設定
&lt;/h2&gt;&lt;pre&gt;&lt;code class=&#34;language-cmake&#34;&gt;if(WIN32)
  message(STATUS &amp;quot;WIN32 で構成中&amp;quot;)
  set(CMAKE_CXX_FLAGS &amp;quot;${CMAKE_CXX_FLAGS} /source-charset:utf-8 /execution-charset:gbk&amp;quot;)
endif()
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;参考文献&#34;&gt;参考文献
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://zhaolan.zhihu.com/p/146543940&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://zhaolan.zhihu.com/p/146543940&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
    </channel>
</rss>
