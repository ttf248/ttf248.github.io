<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>プロキシミラー on 向叔の手帳</title>
        <link>https://ttf248.life/ja/tags/%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7%E3%83%9F%E3%83%A9%E3%83%BC/</link>
        <description>Recent content in プロキシミラー on 向叔の手帳</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ja</language>
        <lastBuildDate>Mon, 02 Jun 2025 07:41:32 +0800</lastBuildDate><atom:link href="https://ttf248.life/ja/tags/%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7%E3%83%9F%E3%83%A9%E3%83%BC/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Docker 国内イメージプロキシが失敗しました。</title>
        <link>https://ttf248.life/ja/p/docker-domestic-mirror-failure/</link>
        <pubDate>Sat, 04 Jan 2025 18:29:25 +0800</pubDate>
        
        <guid>https://ttf248.life/ja/p/docker-domestic-mirror-failure/</guid>
        <description>&lt;p&gt;国内サーバーのDockerデプロイ、デプロイ後に会社がレジストリを提供していない場合、開発者が最初にやるべきことは、国内のレジストリ加速アドレスを設定することです。幸いにも今日、サーバー1台でレジストリ加速アドレスを設定しましたが、イメージの取得中に常に取得できないことがわかりました。
エラーメッセージ：&lt;code&gt;Error response from daemon: Get &amp;quot;https://registry-1.docker.io/v2/&amp;quot;: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)&lt;/code&gt;
&lt;strong&gt;2025年1月6日、2日ぶりにすべてのサーバーが復旧しました。この件は全く話題になりませんでした。国内のすべてのレジストリ代理がダウンしていました&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;障害の切り分けと修復試行&#34;&gt;障害の切り分けと修復試行
&lt;/h2&gt;&lt;p&gt;当初、他のミラー加速アドレスに切り替えて問題を解決することを期待したが、結果は عكسだった。
その後、ローカルDNS設定を修正し、ネットワーク解析レベルで突破口を見つけることを試みたが、結局、デバッグを行った結果、障害は依然として存在した。
この時点で、ローカルネットワークの安定性は疑念を抱くようになり、そこで断行したのは、可能性のあるローカルネットワーク障害点を回避するために携帯電話のテザリングに切り替えることだった。しかし、その結果も落胆させるものであり、問題の改善の兆候は見られなかった。&lt;/p&gt;
&lt;h2 id=&#34;問題の蔓延&#34;&gt;問題の蔓延
&lt;/h2&gt;&lt;p&gt;現在、国内に&lt;strong&gt;数台のサーバーがデプロイされており、すべてDocker環境がインストールされています&lt;/strong&gt;。これらのサーバーからイメージをプルすることを試みましたが、例外なく失敗し、返ってくるエラーメッセージも一様です。これは問題が特定のデバイスに限定されていないことを示唆しています。&lt;/p&gt;
&lt;p&gt;さらに調査したところ、イメージレジストリの代理が瞬く間に機能しなくなっていることが判明しました。この緊迫した状況で、迅速に海外のサーバーを試すと、幸いにもイメージのプルが正常に戻りました。これは問題が国内のネットワークリンクまたは関連設定にある可能性が高いことを意味します。&lt;/p&gt;
&lt;h2 id=&#34;戦略修正迂回戦術&#34;&gt;戦略修正：迂回戦術
&lt;/h2&gt;&lt;p&gt;国内での直接リポジトリ取得の経路が重く制限される中、海外のリポジトリは正常にアクセスできる状況を受けて、プロジェクトを迅速に進めるため、迂回戦術を採用することを決定しました。まず、国外サーバーに切り替えて必要なイメージをスムーズに取得し、その後それを国内イメージレジストリにプッシュすることで、「データブリッジ」を構築します。
同時に、Dockerfileファイルの内容を修正して、イメージのURLを国内環境に適したアドレスに変更し、再度イメージをビルドすることで、最終的に成功裏にデプロイしました。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
