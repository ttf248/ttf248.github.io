<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>社内網アクセス on 向叔の手帳</title>
        <link>https://ttf248.life/ja/tags/%E7%A4%BE%E5%86%85%E7%B6%B2%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9/</link>
        <description>Recent content in 社内網アクセス on 向叔の手帳</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>ja</language>
        <lastBuildDate>Sun, 25 May 2025 14:10:37 +0800</lastBuildDate><atom:link href="https://ttf248.life/ja/tags/%E7%A4%BE%E5%86%85%E7%B6%B2%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>場所を問わないローカルエリアネットワークZeroTier</title>
        <link>https://ttf248.life/ja/p/zero-tier-remote-lan/</link>
        <pubDate>Tue, 19 Sep 2023 04:58:03 +0800</pubDate>
        
        <guid>https://ttf248.life/ja/p/zero-tier-remote-lan/</guid>
        <description>&lt;p&gt;オフィスに新しいminiサーバーを購入しました。環境構築が簡単で、時々自宅からアクセスするニーズもあるので、一時的に内網穿通をデプロイします。これまでの経験から、frpサービスをデプロイし、ポートフォワードを指定します。通常は公衆回線上のサーバーが必要で、接続の品質は公衆回線の帯域幅に依存します。新しいZerotier仮想マシンローカルエリアネットワークを試してみます。VPNに似ており、ローカルに仮想NICを作成し、すべてのマシンを仮想ネットワークに追加します。&lt;/p&gt;
&lt;h2 id=&#34;ゼロティアとは何ですか&#34;&gt;ゼロティアとは何ですか。
&lt;/h2&gt;&lt;p&gt;ZeroTierは、さまざまな地理的な場所にあるデバイス間でセキュアな仮想ネットワークを作成できる、ソフトウェア定義の広域ネットワーク（SD-WAN）ソリューションです。ZeroTierを使用すると、複数のコンピューター、サーバー、およびデバイスをあたかも同じローカルエリアネットワークにいるかのように、仮想的で暗号化されたネットワークに簡単に接続できます。これにより、プログラマーやIT専門家は、複雑なネットワーク設定やVPN構成なしに、さまざまな場所間で安全にデータとリソースを共有できます。&lt;/p&gt;
&lt;p&gt;ゼロティアネットワークは、仮想的なグローバルなローカルエリアネットワークであり、異なるデバイスがインターネット経由で接続し、あたかも同じ物理ネットワーク上に存在するかのように動作します。このネットワークは複数のサブネットを含み、すべてのデバイスはゼロティアの技術によって接続されています。&lt;/p&gt;
&lt;p&gt;惑星サーバー：惑星サーバーはZerotierネットワークの重要なコンポーネントの一つです。これはグローバルであり、Zerotierネットワーク全体のトポロジー構造、ルーティング情報、およびネットワーク状態を維持・管理する役割を担います。惑星サーバーはネットワーク全体を制御する中心的な役割を果たしますが、データそのものを直接転送しません。ユーザーのデバイスはZerotierネットワークに参加するために、少なくとも1つの惑星サーバーに接続する必要があります。&lt;/p&gt;
&lt;p&gt;転送サーバー：転送サーバーはZerotierネットワーク内の補助ノードであり、デバイス間のダイレクト接続を確立するのを支援します。デバイスが直接接続できない場合、データは転送サーバーを通じて送信されます。これにより、ネットワークの到達性とパフォーマンスが向上します。転送サーバーは通常、世界中に配置され、データの転送地点として機能します。&lt;/p&gt;
&lt;p&gt;全体的に見て、Zerotierは、惑星サーバーとリレーサーバーの協力を通じて、デバイスが世界中で仮想ローカルエリアネットワークを構築し、安全かつ高速なデバイス間の通信を実現します。惑星サーバーはグローバルネットワーク管理を担当し、リレーサーバーは必要に応じてデバイス間の通信接続を確立するのに役立ちます。&lt;/p&gt;
&lt;h2 id=&#34;インストールとデプロイ&#34;&gt;インストールとデプロイ
&lt;/h2&gt;&lt;p&gt;ZeroTierの公式サイト（&lt;a class=&#34;link&#34; href=&#34;https://www.zerotier.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.zerotier.com/&lt;/a&gt;）にアクセスして、インストールファイルとドキュメントを入手してください。
お客様のオペレーティングシステムに応じて、ZeroTier Oneクライアントをダウンロードしてインストールしてください。Windows、macOS、Linuxなど、多くのプラットフォームで利用可能です。
インストールが完了したら、ZeroTier Oneクライアントを起動してください。
ZeroTierアカウントを登録してください。まだアカウントをお持ちでない場合は。クライアントで作成できます。
ZeroTierアカウントにログインし、新しいネットワークを作成してください。ネットワークには一意の16桁のIDが割り当てられ、それを覚えておく必要があります。
あなたのデバイスにこのネットワークを追加してください。クライアントでネットワークIDを入力するか、QRコードスキャン機能を使用できます。
ZeroTierクライアントをインストールして設定したデバイスは、同じ仮想ネットワークに追加されます。これらのデバイス間では、あたかも同一のローカルエリアネットワークに接続されているかのように直接通信できるようになります。
ZeroTierのコントロールパネルで、ネットワーク設定の管理、デバイスの追加、ネットワークトラフィックの監視などを行うことができます。&lt;/p&gt;
&lt;h2 id=&#34;moon-のインストールとデプロイ&#34;&gt;moon のインストールとデプロイ
&lt;/h2&gt;&lt;p&gt;国内の通信事業者は多くの場合、&lt;code&gt;UDP&lt;/code&gt;ポートフォワードを禁止しています。&lt;code&gt;frp&lt;/code&gt;サービスは安定しており、&lt;code&gt;TCP&lt;/code&gt;プロトコルを使用しているため、&lt;code&gt;Zerotier&lt;/code&gt;のリレーサーバーをデプロイすることで同様の効果を実現できます。ファイアウォールで&lt;code&gt;udp 9993&lt;/code&gt;を開放する必要があります。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;curl -s https://install.zerotier.com/ | sudo bash
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;インストールが正常に完了しているか確認してください。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli info
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ローカルネットワークに参加する&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli join network-id
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;moon&lt;/code&gt; を作成する&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;cd /var/lib/zerotier-one &amp;amp;&amp;amp; sudo zerotier-idtool initmoon identity.public &amp;gt; moon.json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;設定ファイルを編集し、&lt;code&gt;stableEndpoints&lt;/code&gt;ノードを「サーバーのグローバルIPアドレス/9993」に調整してください。&lt;/p&gt;
&lt;p&gt;署名設定を生成し、&lt;code&gt;moons.d&lt;/code&gt;フォルダを作成。そこにファイルを移動後、サービスを再起動する。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo zerotier-idtool genmoon moon.json
mkdir moons.d &amp;amp;&amp;amp; mv 000000eb444ec0d8.moon moons.d/
systemctl restart zerotier-one.service
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;クライアントノードはmoonサーバーに参加し、IDは前のJSON設定ファイル内のidフィールドから取得されます。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;zerotier-cli.bat orbit ztaddr ztaddr
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# 观察是否出现新的 mooon 节点，id 和信息为服务器配置的相同
[root@idv-36f9d5 ~]# zerotier-cli listpeers
200 listpeers &amp;lt;ztaddr&amp;gt; &amp;lt;path&amp;gt; &amp;lt;latency&amp;gt; &amp;lt;version&amp;gt; &amp;lt;role&amp;gt;
200 listpeers 0cccb***** 35.236.*.*/64393;110;10726 327 1.6.3 LEAF
200 listpeers 3a46f***** 185.180.*.*/9993;110;757 -1 - PLANET
200 listpeers 3ed7c***** 39.97.*.*/9993;172;79 32 1.6.3 MOON
200 listpeers 4f838***** - -1 - LEAF
200 listpeers 62f86***** 50.7.*.*/9993;110;4796 351 - PLANET
200 listpeers 778cd***** 103.195.*.*/9993;5148;4887 253 - PLANET
200 listpeers 992fc***** 195.181.*.*/9993;10161;4921 226 - PLANET
200 listpeers 9d2b5***** - -1 - LEAF
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Windows プラットフォームでは管理者権限でターミナルを起動し、zerotier-cli.bat コマンドライン操作を行い、Linux プラットフォームでは zerotier-cli 操作を行います。peers サブコマンドで接続状況を確認し、listpeers で全てのノードを表示します。「moon」ノードが正常に表示されていれば、接続は成功しています。&lt;/p&gt;
&lt;h2 id=&#34;どうやってアンインストールしますか&#34;&gt;どうやってアンインストールしますか。
&lt;/h2&gt;&lt;p&gt;Windowsプラットフォームのアンインストール方法はここでは割愛します。通常の操作で、コントロールパネルからアンインストールできます。Ubuntuについては重点的に説明します。&lt;/p&gt;
&lt;p&gt;dpkgを使ってzerotier-oneサービスを削除します。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo dpkg -P zerotier-one
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ゼロタイアーワンフォルダを削除してください。このフォルダにはアドレスが保存されており、削除後に再インストールすると新しいアドレスが割り当てられます。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;sudo rm -rf /var/lib/zerotier-one/
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;あとがき&#34;&gt;あとがき
&lt;/h2&gt;&lt;p&gt;元々全てアンインストール済みだったのですが、サーバーが到着しても適切なプロキシノードとなるサービスがなく、アリババクラウドが業績のために開発限定のサーバーを提供してくれました。スペックはそれほど高くありませんが、年間99元と手頃な価格で、2年ほど利用しています。重視したのは、サーバーが提供する帯域幅です。&lt;/p&gt;
&lt;h2 id=&#34;参照資料&#34;&gt;参照資料
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.wnark.com/archives/152.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.wnark.com/archives/152.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/Yogile/p/12642423.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://www.cnblogs.com/Yogile/p/12642423.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
        </item>
        
    </channel>
</rss>
